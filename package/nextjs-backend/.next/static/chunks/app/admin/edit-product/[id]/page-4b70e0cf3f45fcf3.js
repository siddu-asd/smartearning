(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[889],{6596:(e,a,t)=>{Promise.resolve().then(t.bind(t,6399))},6399:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>o});var l=t(5155),r=t(2115),i=t(6046),s=t(8173),d=t.n(s);function o(){let e=(0,i.useRouter)(),a=(0,i.useParams)().id,[t,s]=(0,r.useState)(!0),[o,c]=(0,r.useState)(!1),[n,u]=(0,r.useState)(!1),[m,p]=(0,r.useState)(""),[x,g]=(0,r.useState)({title:"",slug:"",category:"",image_url:"",affiliate_link:"",is_active:!0,mrp:"",discounted_price:""});(0,r.useEffect)(()=>{(async()=>{try{let r=await fetch("/api/admin/products?id=".concat(a));if(r.ok){let i=await r.json(),s=i.data||i,d=Array.isArray(s)?s.find(e=>e.id===a):s;if(d){var e,t,l;g({title:d.title||"",slug:d.slug||"",category:d.category||"",image_url:d.image_url||"",affiliate_link:d.affiliate_link||"",is_active:null===(l=d.is_active)||void 0===l||l,mrp:(null===(e=d.mrp)||void 0===e?void 0:e.toString())||"",discounted_price:(null===(t=d.discounted_price)||void 0===t?void 0:t.toString())||""})}else p("Product not found")}else p("Failed to fetch product")}catch(e){p("Failed to fetch product")}finally{s(!1)}})()},[a]);let b=async e=>{var a;let t=null===(a=e.target.files)||void 0===a?void 0:a[0];if(!t)return;u(!0),p("");let l=new FormData;l.append("file",t);try{let e=await fetch("/api/admin/upload",{method:"POST",body:l}),a=await e.json();e.ok&&a.url?g({...x,image_url:a.url}):p(a.error||"Failed to upload image")}catch(e){p("Failed to upload image")}finally{u(!1)}},h=async t=>{t.preventDefault(),c(!0),p("");try{let t=await fetch("/api/admin/products/".concat(a),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(x)}),l=await t.json();t.ok?e.push("/admin/products"):p(l.error||"Failed to update product")}catch(e){p("Failed to update product")}finally{c(!1)}};return t?(0,l.jsx)("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:(0,l.jsx)("div",{className:"text-gray-500",children:"Loading..."})}):(0,l.jsxs)("div",{className:"min-h-screen bg-gray-100",children:[(0,l.jsx)("header",{className:"bg-white shadow",children:(0,l.jsxs)("div",{className:"max-w-4xl mx-auto px-4 py-6 sm:px-6 lg:px-8 flex justify-between items-center",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Edit Product"}),(0,l.jsx)(d(),{href:"/admin/products",className:"bg-gray-500 text-white px-4 py-2 rounded-md hover:bg-gray-600",children:"← Back to Products"})]})}),(0,l.jsx)("main",{className:"max-w-4xl mx-auto py-6 sm:px-6 lg:px-8",children:(0,l.jsxs)("form",{onSubmit:h,className:"bg-white shadow rounded-lg p-6 space-y-6",children:[m&&(0,l.jsx)("div",{className:"bg-red-50 text-red-600 p-4 rounded-md",children:m}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Title *"}),(0,l.jsx)("input",{type:"text",required:!0,value:x.title,onChange:e=>g({...x,title:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., MacBook Air M2 - Student Discount"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL Slug *"}),(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("input",{type:"text",required:!0,value:x.slug,onChange:e=>g({...x,slug:e.target.value}),className:"flex-1 px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"macbook-air-m2-student-discount"}),(0,l.jsx)("button",{type:"button",onClick:()=>{let e=x.title.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/(^-|-$)/g,"");g({...x,slug:e})},className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300",children:"Generate"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Category *"}),(0,l.jsxs)("select",{required:!0,value:x.category,onChange:e=>g({...x,category:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",children:[(0,l.jsx)("option",{value:"",children:"Select a category"}),(0,l.jsx)("option",{value:"1",children:"Laptop Deals"}),(0,l.jsx)("option",{value:"2",children:"Mobile Deals"}),(0,l.jsx)("option",{value:"3",children:"Home Appliances"}),(0,l.jsx)("option",{value:"4",children:"Laundry & Cleaning"}),(0,l.jsx)("option",{value:"5",children:"Audio & Headphones"}),(0,l.jsx)("option",{value:"6",children:"Study Furniture"}),(0,l.jsx)("option",{value:"7",children:"Entertainment"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product Image"}),(0,l.jsxs)("div",{className:"flex items-start gap-4",children:[x.image_url&&(0,l.jsx)("img",{src:x.image_url,alt:"Preview",className:"w-24 h-24 object-cover rounded-lg border"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("input",{type:"file",accept:"image/*",onChange:b,disabled:n,className:"w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-medium file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"}),n&&(0,l.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Uploading..."}),(0,l.jsx)("input",{type:"text",value:x.image_url,onChange:e=>g({...x,image_url:e.target.value}),placeholder:"Or paste image URL",className:"mt-2 w-full px-4 py-2 border border-gray-300 rounded-md text-sm"})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"MRP (Original Price) ₹"}),(0,l.jsx)("input",{type:"number",value:x.mrp,onChange:e=>g({...x,mrp:e.target.value}),placeholder:"54999",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Discounted Price ₹"}),(0,l.jsx)("input",{type:"number",value:x.discounted_price,onChange:e=>g({...x,discounted_price:e.target.value}),placeholder:"45999",className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Affiliate Link *"}),(0,l.jsx)("input",{type:"url",required:!0,value:x.affiliate_link,onChange:e=>g({...x,affiliate_link:e.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500",placeholder:"https://amazon.com/dp/..."})]}),(0,l.jsxs)("div",{className:"flex items-center gap-3",children:[(0,l.jsx)("input",{type:"checkbox",id:"is_active",checked:x.is_active,onChange:e=>g({...x,is_active:e.target.checked}),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,l.jsx)("label",{htmlFor:"is_active",className:"text-sm font-medium text-gray-700",children:"Product is active and visible on site"})]}),(0,l.jsxs)("div",{className:"flex gap-4 pt-4",children:[(0,l.jsx)("button",{type:"submit",disabled:o||n,className:"flex-1 bg-blue-600 text-white py-3 px-4 rounded-md hover:bg-blue-700 disabled:opacity-50 font-medium",children:o?"Saving...":"Update Product"}),(0,l.jsx)(d(),{href:"/admin/products",className:"px-6 py-3 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"})]})]})})]})}}},e=>{var a=a=>e(e.s=a);e.O(0,[28,441,517,358],()=>a(6596)),_N_E=e.O()}]);